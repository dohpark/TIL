## ES6 함수의 추가 기능

### 함수의 구분

- es6 이전의 모든 함수는 일반 함수로서 호출할 수 있는 것은 생성자 함수로서 호출할 수 있었음.
- 그러나 일반함수로 사용할 것을 생성자 함수로 사용을 하면 가능은 하지만 성능면에서도 문제가 있음.
- 사용 목적에 따라 명확한 구분이 없기에 실수를 유발할 수 있기에 es6에서는 함수 사용 목적에 따라 세가지 종류로 구분을 했음(일반함수, 메서드, 화살표 함수)
- 일반함수는 constructor, prototype, arguments를 지님
- 메서드는 super와 arguments를 지님
- 화살표 함수는 constructor, prototype, super, arguments 모두 없음

### 메서드

- ES6사양에서 메서드는 메서드 축약 표현으로 정의된 함수만을 의미함.
- ES6 사양에서 정의한 메서드는 인스턴스를 생성할 수 없는 non-constructor임
- 따라서 생성자 함수로 호출할 수 없으며, 인스턴스를 생성할 수 없기에 prototype 프로퍼티가 없고, 프로토타입도 생성하지 않음.
- ES6 메서드는 자신을 바인딩한 객체를 가리키는 내부 슬롯 `[[HomeObject]]`를 가짐. super 참조는 내부 슬롯`[[HomeObject]]`를 사용하여 수퍼클래스의 메서드를 참조하는 것임.
- ES6 메서드가 아닌 함수는 내부슬롯 `[[HomeObject]]`이 없기에 super 키워드를 사용할 수 없음

### 화살표 함수

- 화살표 함수 정의

  - 화살표 함수는 function 키워드 대신 화살표(=>)를 사용하여 기존의 함수 정의 방식보다 간략하게 함수를 정의함.
  - 내부 동작도 기존의 함수보다 간략함.
  - 매개변수가 여러개인 경우 소괄호() 안에 매개변수를 선언해야함. 매개변수가 한개이면 소괄호를 생략할 수 있음. 매개변수가 없는 경우에는 소괄호 생략 못함
  - 함수 몸체가 하나의 문으로 구성된다면 함수 몸체를 감싸는 중괄호 {}를 생략할 수 있음. 값으로 평가될 수 있는 표현식인 문이라면 암묵적으로 반환됨.
  - 함수 몸체가 여러개의 문으로 구성된다면 함수 몸체를 감싸는 중괄호를 생략할 수 없음. 반환값 있다면 명시적으로 반환해야함.

- 화살표 함수와 일반 함수의 차이

  - 화살표 함수는 인스턴스를 생성할 수 없는 non-constructor임.
    - 인스턴스를 생성할 수 없으며, prototype 프로퍼티도 없고 프로토타입도 생성하지 않음.
  - 중복된 매개변수 이름을 선언할 수 없음.
    - 일반 함수는 쭝복된 매개변수 이름을 선언해도 에러가 발생하지 않음.(strict mode에서는 에러가 발생함)
    - 화살표 함수에서 중복된 매개변수 이름을 선언하면 에러가 발생함.
  - 화살표 함수는 함수 자체의 this, arguments, super, new.target 바인딩을 갖지 않음.
    - 화살표 함수 내부에서 this, arguments, super, new.target을 참조하면 스코프 체인을 통해 상위 스코프의 this, arguments, super, new.target을 참조함.
    - 만약에 화살표 함수와 화살표 함수가 중첩되어 있는 경우 가장 가까운 상위 함수 중에서 화살표 함수가 아닌 함수의 this, arguments, super, new.target을 참조함.

- this

  - 화살표 함수의 this는 일반함수의 this와 다르게 동작함. 이는 콜백 함수 내부의 this문제를 해결하기 위해 의도적으로 설계된 것임.
  - this 바인딩은 함수가 어떻게 호출되었는지에 따라 this 바인딩할 객체가 동적으로 결정됨.
  - 고차함수의 인수로 전달되어 고차 함수 내부에서 호출되는 콜백함수는 일반함수로서 호출하기 때문에 this는 일반적으로 전역객체, strict mode에서는 undefined가 바인딩됨.
  - 이를 해결하기 es6 이전에는
    - 01 that을 사용해 this를 회피시킨 후에 콜백 함수 내부에서 that을 사용했음
    - 02 Array.prototype.map의 경우 두번째 인수로 콜백 내부에서 this로 사용할 객체를 전달 할 수 있음 (this묹제 때문에 )
    - 03 Function.prototype.bind 메서드를 사용해 this를 바인딩하여 사용했음
  - 화살표 함수는 함수 자체의 this 바인딩을 갖지 않아 화살표 함수 내부에서 this 참조시 상위 스코프의 this를 참조함. 이를 lexical this라고 부름.
  - 화살표 함수는 함수 자체의 this 바인딩을 갖지 않기에 Function.prototype.call, apply, bind 메서드를 사용해도 화살표 함수 내부의 this를 교체 못함.
  - 메서드(일반적 의미의 메서드)를 화살표 함수로 정의하는 것을 피해야함. 화살표 함수의 this는 다르게 동작하기에 의도와 다르게 동작할 수 있음.
  - 프로토타입 객체의 프로퍼티에 화살표 함수를 할당하는 경우도 동일한 문제가 발생함.
  - 프로퍼티를 동적으로 추가할 때 es6 메서드 정의를 사용할 수 없기에 일반 함수를 할당함.
  - es6 메서드를 동적으로 추가하고 싶다면 객체 리터럴을 바인딩하고 프로토타입의 constructor 프로퍼티와 생성자 함수 간의 연결을 재설정해야함 (26-43 참고)
  - 클래스 필드 정의 제안을 사용하여 클래스 필드에 화살표 함수를 할당할 수 있음. 이 경우 this는 클래스가 생성할 인스턴스를 참조함. 왜냐하면 클래스 필드 정의 제안은 constructor에서 this를 바인딩하여 생성하는 것인데 이 때 this가 클래스가 생성할 인스턴스이기 때문임.
  - 즉 클래스 필드에 할당한 화살표 함수는 인스턴스가 되며, 원래 축약 메서드를 넣어서 프로토타입 메서드로 만드는 경우와 다르기에 주의해야함.

- super

  - 화살표 함수는 함수 자체의 super 바인딩이 없기에 화살표 함수 내부에서 super 참조시 상위 스코프의 super를 참조함.
  - super는 내부슬롯 `[[HomeObject]]`를 갖는 es6 메서드 내에서만 사용할 수 있는 키워드임. 화살표 함수는 super 바인딩을 갖지 않으므로 super 참조해도 에러가 발생하지 않음.

- arguments

  - 화살표 함수는 arguments 바인딩을 갖지 않기에 화살표 함수 내부에서 arguments를 참조하면 상위 스코프의 arguments를 참조함.
  - arguments를 참조할 수 없기에 가변 인자 함수로 사용시에 rest 파라미터를 사용함.

### Rest 파라미터

- 기본문법

  - Rest 파라미터는 매개변수 이름 앞에 세개의 점 ...을 붙여서 정의한 매개변수를 의미함. Rest 파라미터는 함수에 전달된 인수들의 목록을 배열로 전달받음.
  - 매개변수와 Rest 파라미터는 함께 사용가능함. 함수에 전달된 인수들은 매개변수와 Rest 파라미터에 순차적으로 할당됨.
  - Rest 파라미터는 반드시 마지막 파라미터이어야 함
  - Rest 파라미터는 단ㄴ 하나만 선언할 수 있음
  - Rest 파라미터는 함수 정의 시 선언한 매개변수 개수를 나타내는 함수 객체의 length 프로퍼티에 영향을 주지 않음.

- Rest 파라미터와 arguments 객체

  - ES5에서는 가변 인자 함수의 경우 매개변수를 통해 인수를 전달받는 것이 불가능하여 arguments 객체를 활용하여 인수를 전달받았음.
  - arguments 함수 내부에서 사용 가능하지만 유사배열 객체이기에 배열 메서드를 사용하려면 Function.call or Function.prototype.apply 메서드를 사용해 arguments 객체를 배열로 변환해야했음
  - 그러나 ES6부터 rest 파라미터를 사용하여 가변 인자 함수의 인수 목록을 배열로 전달 받을 수 있어 굳이 arguments 객체를 배열로 변환 안해도 됨.
  - 화살표 함수는 arguments 객체를 갖지 않으므로 가변인자 함수 구현시 반드시 rest 파라미터를 사용해야함.

### 매개변수 기본값

- 매개변수 기본값은 ES6에서 도입되었으며 사용 시 함수 내에서 수행하던 인수 체크 및 초기화를 간소화할 수 있음.
- 매개변수 기본값은 매개변수에 인수를 전달하지 않은경우와 undefined를 전달한 경우에만 유효함.
- rest 파라미터에는 기본값을 지정할 수 없음
- 함수 객체의 length 프로퍼티와 arguments 객체에 영향을 주지 않음.
